package main

import (
	"fmt"
	"net/http"
	"net/url"
	"os"
	"strings"

	"github.com/PuerkitoBio/goquery"
)

var keywords = []string{
	"机械有限公司",
	"五金有限公司",
	"电气有限公司",
	"机床有限公司",
	"电子有限公司",
	"灯饰有限公司",
	"环保有限公司",
	"印刷有限公司",
	"工程机械有限公司",
	"汽配有限公司",
	"泵阀有限公司",
	"纸业有限公司",
	"仪器仪表有限公司",
	"安防有限公司",
	"汽车有限公司",
	"汽修有限公司",
	"通信有限公司",
	"过滤有限公司",
	"消防有限公司",
	"加工有限公司",
	"汽车用品有限公司",
	"丝印特印有限公司",
	"包装有限公司",
	"LED有限公司",
	"水工业有限公司",
	"二手设备有限公司",
	"广电有限公司",
	"耐火材料有限公司",
	"焊接切割有限公司",
	"暖通空调有限公司",
	"添加剂有限公司",
	"纸管有限公司",
	"太阳能有限公司",
	"物流设备有限公司",
	"热泵有限公司",
	"工控有限公司",
	"紧固件有限公司",
	"IT有限公司",
	"家电有限公司",
	"礼品有限公司",
	"家居有限公司",
	"运动休闲有限公司",
	"家具有限公司",
	"办公有限公司",
	"酒店有限公司",
	"美容美发有限公司",
	"教育装备有限公司",
	"服装有限公司",
	"服饰有限公司",
	"古玩有限公司",
	"玩具有限公司",
	"制鞋有限公司",
	"音响灯光有限公司",
	"小家电有限公司",
	"皮具有限公司",
	"零食有限公司",
	"智能有限公司",
	"二手有限公司",
	"珠宝有限公司",
	"影音有限公司",
	"宠物有限公司",
	"母婴有限公司",
	"消毒产品有限公司",
	"商务服务有限公司",
	"生活服务有限公司",
	"广告有限公司",
	"教育有限公司",
	"物流有限公司",
	"交通运输有限公司",
	"网站建设有限公司",
	"展会有限公司",
	"维修有限公司",
	"项目有限公司",
	"创业有限公司",
	"船舶有限公司",
	"二手回收有限公司",
	"翻译有限公司",
	"建材有限公司",
	"能源有限公司",
	"冶金有限公司",
	"纺织有限公司",
	"化工有限公司",
	"表面处理有限公司",
	"房地产有限公司",
	"超硬材料有限公司",
	"塑料有限公司",
	"钢铁有限公司",
	"橡胶有限公司",
	"皮革有限公司",
	"丝网有限公司",
	"涂料有限公司",
	"石材有限公司",
	"石油有限公司",
	"卫浴有限公司",
	"陶瓷有限公司",
	"玻璃有限公司",
	"养殖有限公司",
	"水果批发有限公司",
	"食品有限公司",
	"食品机械有限公司",
	"农机有限公司",
	"园林有限公司",
	"农化有限公司",
	"饲料有限公司",
	"茶叶有限公司",
	"种子有限公司",
	"蔬菜有限公司",
	"广告/广告/公关有限公司",
	"广告设计制作有限公司",
	"广告材料有限公司",
	"户外媒体广告有限公司",
	"喷绘材料有限公司",
	"广告展示架有限公司",
	"广告礼品有限公司",
	"喷绘打印机有限公司",
	"影像传输设备有限公司",
	"雕刻切割设备有限公司",
	"标牌制作设备有限公司",
	"广告光电产品有限公司",
	"POP广告有限公司",
	"丝丝印移印机有限公司",
	"教育培训有限公司",
	"职业技能培训有限公司",
	"文艺/体育培训有限公司",
	"IT培训有限公司",
	"管理有限公司",
	"外语培训有限公司",
	"婴幼儿教育有限公司",
	"设计培训有限公司",
	"家教有限公司",
	"国内货运物流有限公司",
	"物流服务有限公司",
	"出口货运物流有限公司",
	"物流车源有限公司",
	"物流园区有限公司",
	"物流软件有限公司",
	"物流货源有限公司",
	"交通安全设备有限公司",
	"非机动车有限公司",
	"仓储设备有限公司",
	"公路机械设备有限公司",
	"桥用材料有限公司",
	"集装整理设备有限公司",
	"起重装卸设备有限公司",
	"非机动车配件有限公司",
	"电梯/甲板设备有限公司",
	"运输搬运设备有限公司",
	"交通仪器仪表有限公司",
	"二手交通工具转让有限公司",
	"土工材料有限公司",
	"物流辅助器材有限公司",
	"公路材料有限公司",
	"通用输送设备有限公司",
	"机动车有限公司",
	"船用发动机/配件有限公司",
	"船舶救生设备有限公司",
	"摩托车有限公司",
	"船舶通讯/泵阀有限公司",
	"废弃物处理设施有限公司",
	"网站制作有限公司",
	"网络营销推广有限公司",
	"软件开发有限公司",
	"互联网增值服务有限公司",
	"网站服务器有限公司",
	"网站设计有限公司",
	"外包服务有限公司",
	"移动开发有限公司",
	"网站域名有限公司",
	"展览/展会有限公司",
	"服务业展会有限公司",
	"消费品展会有限公司",
	"工业品展会有限公司",
	"原材料展会有限公司",
	"机械设备维修有限公司",
	"家电家居维修有限公司",
	"电脑网络维修有限公司",
	"维修点|维修店有限公司",
	"办公设备维修有限公司",
	"交通设备维修有限公司",
	"通讯产品维修有限公司",
	"数码产品维修有限公司",
	"美容健身器材维修有限公司",
	"消防器材维修有限公司",
	"行业合作有限公司",
	"技术专利有限公司",
	"转让租赁有限公司",
	"施工项目有限公司",
	"餐饮食品加盟有限公司",
	"家居建材加盟有限公司",
	"服装服饰加盟有限公司",
	"电子产品加盟有限公司",
	"母婴用品加盟有限公司",
	"礼品饰品加盟有限公司",
	"健身瘦身加盟有限公司",
	"货运加盟有限公司",
	"房产加盟有限公司",
	"图书馆加盟有限公司",
	"船舶舾装设备有限公司",
	"船舶系统有限公司",
	"船用材料有限公司",
	"船用电气设备有限公司",
	"船舶动力装置有限公司",
	"船舶辅机设备有限公司",
	"非船产品有限公司",
	"船舶通讯导航有限公司",
	"甲板机械设备有限公司",
	"本地生活服务网有限公司",
	"装修装饰有限公司",
	"车辆服务有限公司",
	"管道疏通有限公司",
	"摄影摄像有限公司",
	"餐饮有限公司",
	"保洁清洗有限公司",
	"房屋家居维修有限公司",
	"旅游有限公司",
	"租赁有限公司",
	"家政有限公司",
	"搬家有限公司",
	"运动健身有限公司",
	"婚庆有限公司",
	"公共服务/专业机构有限公司",
	"礼仪庆典有限公司",
	"生活配送有限公司",
	"美发美体有限公司",
	"度假/郊游有限公司",
	"票务/卡券有限公司",
	"礼品鲜花有限公司",
	"咨询服务有限公司",
	"注册有限公司",
	"招商加盟有限公司",
	"创意设计/设计有限公司",
	"中介服务有限公司",
	"装修有限公司",
	"会计服务有限公司",
	"资产管理服务有限公司",
	"产权商标有限公司",
	"劳务派遣有限公司",
	"企业认证有限公司",
	"租车有限公司",
	"设备租赁维修有限公司",
	"资产评估有限公司",
	"清洗/保洁服务有限公司",
	"检测服务有限公司",
	"商务翻译有限公司",
	"旅行社/商旅服务有限公司",
	"百货商场/大超市有限公司",
	"行政内勤有限公司",
	"拆除清运有限公司",
	"水下作业/潜水施工有限公司",
	"辐照加工服务有限公司",
	"门窗五金件有限公司",
	"管材管件有限公司",
	"板材有限公司",
	"水暖五金件有限公司",
	"木材有限公司",
	"金属建材有限公司",
	"门建材有限公司",
	"地板有限公司",
	"建材加工合作有限公司",
	"隔断/吊顶有限公司",
	"防水防潮材料有限公司",
	"保温/隔热材料有限公司",
	"窗建材有限公司",
	"铝型建材有限公司",
	"装修辅材有限公司",
	"水泥砖瓦有限公司",
	"建材胶粘剂有限公司",
	"瓷砖有限公司",
	"墙体材料有限公司",
	"工地施工材料有限公司",
	"水龙头有限公司",
	"混凝土/商砼有限公司",
	"安防用品有限公司",
	"栏杆有限公司",
	"建材生产加工机械有限公司",
	"耐火/防火材料有限公司",
	"脚手架有限公司",
	"集成房屋有限公司",
	"建筑模板有限公司",
	"建筑维修有限公司",
	"管道系统有限公司",
	"石灰石膏有限公司",
	"工业门有限公司",
	"淋浴房/淋浴房配件有限公司",
	"匠作工具有限公司",
	"梯子有限公司",
	"马桶/马桶配件有限公司",
	"陶瓷生产加工机械有限公司",
	"卫浴五金件有限公司",
	"线材有限公司",
	"彩色防滑路面有限公司",
	"二手建材加工设备有限公司",
	"洗脸盆有限公司",
	"枕木有限公司",
	"电池有限公司",
	"发电机/发电机组有限公司",
	"原煤有限公司",
	"能源泵有限公司",
	"石油燃料有限公司",
	"太阳能设备有限公司",
	"节能设备有限公司",
	"锅炉有限公司",
	"润滑油有限公司",
	"煤矿设备有限公司",
	"新能源|生物燃料有限公司",
	"电源有限公司",
	"输电设备/线路材料有限公司",
	"石油加工设备有限公司",
	"沼气工程设备有限公司",
	"钢材有限公司",
	"铁合金有限公司",
	"有色金属有限公司",
	"非金属矿产有限公司",
	"铝材料有限公司",
	"铜材料有限公司",
	"废金属有限公司",
	"锌材料有限公司",
	"矿业设备有限公司",
	"冶金设备有限公司",
	"选矿设备有限公司",
	"非金属矿物制品有限公司",
	"有色金属制品有限公司",
	"粉末冶金有限公司",
	"金属合金制品有限公司",
	"黑色金属制品有限公司",
	"镍材料有限公司",
	"贵金属/半金属有限公司",
	"冶金炉料有限公司",
	"铅材料有限公司",
	"纺织原料有限公司",
	"床上用品有限公司",
	"家纺有限公司",
	"面料有限公司",
	"纺织辅料有限公司",
	"纱线丝有限公司",
	"皮革制品有限公司",
	"纺织品库存有限公司",
	"坯布有限公司",
	"纺织化工助剂有限公司",
	"纺织工艺品有限公司",
	"纺机有限公司",
	"有机化工原料有限公司",
	"化学助剂有限公司",
	"胶粘剂有限公司",
	"化工机械设备有限公司",
	"无机化工原料有限公司",
	"橡胶原料橡胶制品有限公司",
	"合成树脂有限公司",
	"农药/化肥有限公司",
	"表面处理设备有限公司",
	"化学纤维有限公司",
	"雕刻机有限公司",
	"电火花/线切割有限公司",
	"齿轮加工有限公司",
	"激光加工机床有限公司",
	"切割焊接有限公司",
	"木工锯床有限公司",
	"二手专用机床有限公司",
	"等离子切割有限公司",
	"铸造设备有限公司",
	"室外设施有限公司",
	"房产有限公司",
	"房产服务有限公司",
	"房产开发有限公司",
	"室内设施有限公司",
	"社区休闲设施有限公司",
	"金属粉末有限公司",
	"超硬制品有限公司",
	"普通磨具有限公司",
	"超硬材料工具设备有限公司",
	"超硬材料辅材有限公司",
	"石材/石材养护有限公司",
	"普通磨料有限公司",
	"建筑钢材有限公司",
	"特殊钢有限公司",
	"炼钢炉料有限公司",
	"优钢有限公司",
	"钨钢有限公司",
	"橡胶制品有限公司",
	"橡胶机械设备有限公司",
	"合成橡胶有限公司",
	"天然橡胶有限公司",
	"轮胎/力车胎有限公司",
	"橡胶助剂/炭黑有限公司",
	"骨架材料有限公司",
	"原料皮有限公司",
	"皮革化工有限公司",
	"皮革辅料/皮革五金有限公司",
	"球类皮革有限公司",
	"皮革机械有限公司",
	"箱包皮包有限公司",
	"订做鞋/制鞋有限公司",
	"成品革有限公司",
	"人造革有限公司",
	"裘皮制品有限公司",
	"成革服装有限公司",
	"护栏网有限公司",
	"铁丝网有限公司",
	"石笼网有限公司",
	"筛网有限公司",
	"防护网有限公司",
	"冲拉网有限公司",
	"焊接丝网有限公司",
	"编织网有限公司",
	"电焊网有限公司",
	"丝网机械有限公司",
	"爬架网有限公司",
	"不锈钢网有限公司",
	"钢板网有限公司",
	"非织造网有限公司",
	"拉拔丝网有限公司",
	"勾花网有限公司",
	"防风抑尘网有限公司",
	"窗纱有限公司",
	"轧花网有限公司",
	"涂料原料有限公司",
	"涂料设备有限公司",
	"润滑油剂有限公司",
	"石油产品有限公司",
	"石油添加剂有限公司",
	"原油/天然气有限公司",
	"石油催化剂有限公司",
	"灯具有限公司",
	"吊顶有限公司",
	"家居日用品有限公司",
	"家装有限公司",
	"家用餐具/厨具有限公司",
	"门窗型材有限公司",
	"油漆涂料有限公司",
	"家用电器有限公司",
	"壁纸窗帘有限公司",
	"橱柜有限公司",
	"散热器有限公司",
	"家装电器有限公司",
	"壁柜和衣帽间有限公司",
	"活性炭有限公司",
	"电工电料有限公司",
	"畜牧业机械有限公司",
	"禽类有限公司",
	"鱼类有限公司",
	"畜牧养殖有限公司",
	"养牛有限公司",
	"兽药有限公司",
	"养猪有限公司",
	"养羊有限公司",
	"养犬有限公司",
	"海鲜类有限公司",
	"龟鳖类有限公司",
	"两栖爬行有限公司",
	"水产养殖设备有限公司",
	"水产渔药/水产药品有限公司",
	"消毒设备有限公司",
	"鱼苗有限公司",
	"虾类有限公司",
	"环控设备有限公司",
	"蟹类有限公司",
	"昆虫养殖有限公司",
	"笼床栏具有限公司",
	"垂钓渔具有限公司",
	"海产品干货有限公司",
	"温控设备有限公司",
	"观赏鱼有限公司",
	"养马有限公司",
	"食用菌种植有限公司",
	"特种水产养殖有限公司",
	"鲜活海产品有限公司",
	"冷冻海产品有限公司",
	"饲喂饮水设备有限公司",
	"水产捕捞设备有限公司",
	"蟹类苗种有限公司",
	"贝类苗种有限公司",
	"水产加工设备有限公司",
	"养殖水面有限公司",
	"驴养殖有限公司",
	"软体类海鲜苗种有限公司",
	"龟鳖类苗种有限公司",
	"水产运输设备有限公司",
	"生鲜水果有限公司",
	"坚果/干果有限公司",
	"水果加工食品有限公司",
	"苹果有限公司",
	"西瓜有限公司",
	"葡萄有限公司",
	"鲜梨有限公司",
	"热带水果有限公司",
	"芒果有限公司",
	"加工食品有限公司",
	"茶叶/饮料有限公司",
	"调味品有限公司",
	"白酒有限公司",
	"粮食/粗粮有限公司",
	"水果蔬菜有限公司",
	"食品添加剂有限公司",
	"食用油有限公司",
	"米面有限公司",
	"生鲜肉有限公司",
	"活禽/水产品有限公司",
	"有机食品有限公司",
	"食糖有限公司",
	"蛋类有限公司",
	"冰块有限公司",
	"加工机械有限公司",
	"种植业机械有限公司",
	"拖拉机有限公司",
	"运输和工程机械有限公司",
	"园林机械有限公司",
	"排灌机械有限公司",
	"肥料机械设备有限公司",
	"种子机械有限公司",
	"内燃机有限公司",
	"苗木有限公司",
	"园林景观有限公司",
	"温室设备有限公司",
	"花卉有限公司",
	"果树种植机械有限公司",
	"园林工具有限公司",
	"园林栽培基质有限公司",
	"肥料有限公司",
	"农药有限公司",
	"原药有限公司",
	"茶具有限公司",
	"绿茶有限公司",
	"功能茶有限公司",
	"花茶有限公司",
	"茶叶包装有限公司",
	"加工茶有限公司",
	"白茶有限公司",
	"黑茶有限公司",
	"青茶有限公司",
	"红茶有限公司",
	"黄茶有限公司",
	"植物种子种苗有限公司",
	"苗木/果木种子有限公司",
	"油料/粮食种子有限公司",
	"豆类/薯类种子有限公司",
	"瓜果类种子有限公司",
	"白菜/甘蓝类种子有限公司",
	"叶菜类种子有限公司",
	"食用菌类有限公司",
	"叶菜类有限公司",
	"茄果类有限公司",
	"葱蒜类有限公司",
	"瓜类有限公司",
	"豆类/薯芋类有限公司",
	"多年生类蔬菜有限公司",
	"根菜类有限公司",
	"水生类蔬菜有限公司",
	"特菜类有限公司",
}
var visitedUrl = make(map[string]bool)
var resultFile *os.File

func main() {
	var err error
	resultFile, err = os.OpenFile("result.json", os.O_CREATE|os.O_APPEND|os.O_RDWR, os.ModePerm)
	if err != nil {
		fmt.Println(err.Error())
		return
	}

	for _, keyword := range keywords {
		for i := 0; i < 30; i++ {
			googleSearch(keyword, i*10)
		}
		os.WriteFile("已完成关键词.txt", []byte(keyword), os.ModePerm)
		fmt.Println(keyword)
	}

}
func googleSearch(keyword string, start int) {
	requestUrl := fmt.Sprintf("https://www.google.com/search?q=%s&start=%d", keyword, start)
	request, _ := http.NewRequest("GET", requestUrl, nil)
	resp, err := http.DefaultClient.Do(request)
	if err != nil {
		fmt.Println(err.Error())
		return
	}

	doc, err := goquery.NewDocumentFromReader(resp.Body)
	if err != nil {
		fmt.Println(err.Error())
		return
	}
	doc.Find("a[data-ved]").Each(func(i int, s *goquery.Selection) {
		href := s.AttrOr("href", "")
		if strings.Index(href, "/url") != 0 {
			return
		}
		u, err := url.Parse(href)
		if err != nil {
			return
		}
		q := u.Query().Get("q")
		u, err = url.Parse(q)
		if err != nil {
			return
		}
		if u.Scheme == "" || u.Host == "" {
			return
		}
		err = fetchCompanySite(u.Scheme + "://" + u.Host)
		if err != nil {
			fmt.Println(err.Error())
		}
	})
}
func fetchCompanySite(requestUrl string) error {
	if visitedUrl[requestUrl] {
		return nil
	}
	defer func() { visitedUrl[requestUrl] = true }()
	request, err := http.NewRequest("GET", requestUrl, nil)
	if err != nil {
		return err
	}
	request.Header.Set("User-Agent", "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36")
	resp, err := http.DefaultClient.Do(request)
	if err != nil {
		return err
	}
	doc, err := goquery.NewDocumentFromReader(resp.Body)
	if err != nil {
		return err
	}
	replacer := strings.NewReplacer(" ", "", "\n", "", " ", "", "\r", "")
	title := replacer.Replace(doc.Find("title").Text())
	keywords := replacer.Replace(doc.Find("meta[name=keywords]").AttrOr("content", ""))
	description := replacer.Replace(doc.Find("meta[name=description]").AttrOr("content", ""))
	_, err = resultFile.WriteString(fmt.Sprintf("%s,%s,%s,%s\n", requestUrl, title, keywords, description))
	if err != nil {
		return err
	}
	return nil

}
